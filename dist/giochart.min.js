!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("lodash"),require("G2")):"function"==typeof define&&define.amd?define(["react","lodash","G2"],e):"object"==typeof exports?exports.GrChart=e(require("react"),require("lodash"),require("G2")):t.GrChart=e(t.React,t.lodash,t.G2)}(this,function(t,e,r){return function(t){function e(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return t[a].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var a=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},n=r(1),o=r(2),i=r(3);e.HttpStatus={Ok:200,Created:201,NoContent:204,MovedPermanently:301,SeeOther:303,NotModified:304,BadRequest:400,Unauthorized:401,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,RequestTimeout:408,UnsupportedEntity:422,Locked:423,TooManyRequests:429,InternalServerError:500,NotImplemented:501};var c=function(t){function r(e){var r=t.call(this,e)||this;return r.state={isLoading:!0},r}return a(r,t),r.prototype.render=function(){return n.createElement("div",null,n.createElement("div",{ref:"chartArea"}))},r.prototype.defaultRequest=function(t,r){return fetch("/assets/demo.json").then(function(t){var r=t.status;if(r===e.HttpStatus.Ok)return t.json()}).then(function(e){return r(t,e)})},r.prototype.componentDidMount=function(){var t=this.props,e=t.chartParams,r=t.chartData;return this.props.hasOwnProperty("chartData")?(this.chart&&this.chart.destroy(),this.drawChart(e,r),!0):void this.defaultRequest(e,this.drawChart.bind(this))},r.prototype.shouldComponentUpdate=function(t){var e=t.chartParams,r=t.chartData;return!t.hasOwnProperty("chartData")||(this.chart&&this.chart.destroy(),this.drawChart(e,r),!0)},r.prototype.drawChart=function(t,e){var r=document.createElement("div");this.refs.chartArea.appendChild(r);var a=new i.Chart({container:r,height:r.getBoundingClientRect().height||450,forceFit:!0,plotCfg:{}}),n=this.createSourceConfig(t,e.meta),c=o.map(e.meta,"id"),s=o.map(e.data,function(t){return o.zipObject(c,t)}),u=new i.Frame(s),p=o.filter(e.meta,{isDim:!1}),d=o.map(p,"id"),l=o.map(o.filter(e.meta,{isDim:!0}),"id");if("bubble"!==t.chartType&&t.metrics.length>1){u=i.Frame.combinColumns(u,d,"val","metric",l),l.push("metric"),d=["val"];var h=o.fromPairs(o.map(p,function(t){return[t.id,t.name]})),m=u.colArray("metric"),f=m.map(function(t){return h[t]});u.colReplace("metric",f)}a.source(u,n),a.axis("tm",{title:!1}),a.axis("val",{title:!1});var y,v=this.caculateGeom(a,t.chartType,t.attrs.subChartType);y="bubble"===t.chartType?d[0]+"*"+d[1]:"funnel"===t.chartType?i.Stat.summary.sum("metric*val"):l[0]+"*"+d[0],v.position(y),"funnel"===t.chartType?v.color("metric",["#C82B3D","#EB4456","#F9815C","#F8AB60","#EDCC72"]).label("metric",{offset:10,label:{fontSize:14}}):l.length>1&&v.color(l[1]),a.render(),this.chart=a},r.prototype.createSourceConfig=function(t,e){var r={};if(e.forEach(function(t){return r[t.id]={alias:t.name}}),o.find(e,{id:"tm"})){var a={alias:"时间",type:"time",mask:"mm-dd",nice:!0,tickCount:7};"day:8,1"===t.timeRange&&(a.tickCount=7),864e5===t.interval?a.mask="mm-dd":36e5===t.interval&&(a.mask="HH:mm"),"bar"!==t.chartType&&"vbar"!==t.chartType||(a.type="timeCat"),r.tm=a}return r},r.prototype.caculateGeom=function(t,e,r){var a;return"seperate"===r?a="dodge":"total"===r?a="stack":"percent"===r&&(a="stack"),"bar"===e?(t.coord("rect").transpose(),t.interval(a)):"vbar"===e?t.interval(a):"funnel"===e?(t.coord("rect").transpose().scale(1,-1),t.axis(!1),t.intervalSymmetric().shape("funnel")):"bubble"===e?t.point():"line"===e?t.line().size(2):t[e](a)},r}(n.Component);Object.defineProperty(e,"__esModule",{value:!0}),e.default=c},function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e){t.exports=r}])});